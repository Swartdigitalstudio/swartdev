"use strict";(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[6020],{8940:(e,t,s)=>{s.d(t,{Z:()=>n});var a=s(73305),r=s(4637);function n(e){var t=e.step,s=e.saveConfig,n=e.edit,o=e.disabled;return n?(0,r.jsx)("div",{className:"txt-center w-9 mt-3",children:(0,r.jsx)("button",{onClick:s,id:"secondary-update-btn",className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:o,children:(0,a.__)("Update","bitform")})}):(0,r.jsxs)("div",{className:"btcd-stp-page txt-center",style:{width:3===t&&"90%",height:3===t&&"100%"},children:[(0,r.jsx)("h2",{className:"ml-3",children:(0,a.__)("Successfully Integrated","bitform")}),(0,r.jsxs)("button",{onClick:s,id:"secondary-update-btn",className:"btn btcd-btn-lg green sh-sm",type:"button",children:[(0,a.__)("Finish & Save ","bitform")," ✔"]})]})}},94253:(e,t,s)=>{s.d(t,{Rx:()=>o,h4:()=>d,Co:()=>c,kS:()=>h});var a=s(665),r=s(73305),n=s(77111),o=function(e,t,s,r,n,o,d,c,h){var u=(0,a.Z)({},t);if(d){var m=(0,a.Z)({},c);m[e.target.name]="",h((0,a.Z)({},m))}switch(u[e.target.name]=e.target.value,e.target.name){case"workbook":u=l(u,r,s,n,o);break;case"worksheet":u=i(u,r,s,n,o)}s((0,a.Z)({},u))},l=function(e,t,s,r,n){var o,l,i,d,u=(0,a.Z)({},e);if(u.worksheet="",u.field_map=[{formField:"",zohoFormField:""}],null!=u&&null!=(o=u.default)&&null!=(l=o.worksheets)&&l[e.workbook]){if(1===Object.keys(null==u||null==(i=u.default)||null==(d=i.worksheets)?void 0:d[e.workbook]).length){var m,f,b,k,p;u.worksheet=null==u||null==(m=u.default)||null==(f=m.worksheets)?void 0:f[e.workbook][0].viewName,null!=u&&null!=(b=u.default)&&null!=(k=b.worksheets)&&null!=(p=k.headers)&&p[u.worksheet]||h(t,u,s,r,n)}}else c(t,u,s,r,n);return u},i=function(e,t,s,r,n){var o,l,i,d=(0,a.Z)({},e);return d.field_map=[{formField:"",zohoFormField:""}],null!=d&&null!=(o=d.default)&&null!=(l=o.worksheets)&&null!=(i=l.headers)&&i[e.worksheet]||h(t,d,s,r,n),d},d=function(e,t,s,o,l){o(!0);var i={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,ownerEmail:t.ownerEmail};(0,n.Z)(i,"bitforms_zsheet_refresh_workbooks").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);n.default||(n.default={}),e.data.workbooks&&(n.default.workbooks=e.data.workbooks),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,r.__)("Workbooks refreshed","bitform")}),s((0,a.Z)({},n))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:(0,r.g)((0,r.__)("Workbooks refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):l({show:!0,msg:(0,r.__)("Workbooks refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))},c=function(e,t,s,o,l){var i=t.workbook;if(i){o(!0);var d={formID:e,workbook:i,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,n.Z)(d,"bitforms_zsheet_refresh_worksheets").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);e.data.worksheets&&(n.default.worksheets||(n.default.worksheets={}),n.default.worksheets[i]=e.data.worksheets),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,r.__)("Worksheets refreshed","bitform")}),s((0,a.Z)({},n))}else l({show:!0,msg:(0,r.__)("Worksheets refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))}},h=function(e,t,s,o,l){var i=t.workbook,d=t.worksheet,c=t.headerRow;if(d){o(!0);var h={formID:e,workbook:i,worksheet:d,headerRow:c,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,ownerEmail:t.ownerEmail};(0,n.Z)(h,"bitforms_zsheet_refresh_worksheet_headers").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);e.data.worksheet_headers.length>0?(n.default.worksheets.headers||(n.default.worksheets.headers={}),n.default.worksheets.headers[d]||(n.default.worksheets.headers[d]={}),n.default.worksheets.headers[d][c]=e.data.worksheet_headers,e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,r.__)("Worksheet Headers refreshed","bitform")})):l({show:!0,msg:(0,r.__)("No Worksheet headers found. Try changing the header row number or try again","bitform")}),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),s((0,a.Z)({},n))}else l({show:!0,msg:(0,r.__)("Worksheet Headers refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))}}},80058:(e,t,s)=>{s.d(t,{Z:()=>_});var a=s(73305),r=s(67860),n=s(53132),o=s(665),l=s(59496),i=s(19753),d=s(44246),c=s(2598),h=s(12859),u=s(31702),m=s(4637);function f(e){var t,s,r,n,f,b,k,p,w,x,v,j,_,g,C,N=e.sheetConf,Z=e.setSheetConf,y=e.formFields,F=(0,l.useState)(!1),S=F[0],R=F[1],D=(0,l.useState)({show:!1}),I=D[0],W=D[1],M=function(e,t){var s=(0,o.Z)({},N);s.actions.update[t]=e,Z((0,o.Z)({},s))},L=function(){var e=[{title:"Form Fields",type:"group",childs:[]}];return e[0].childs=y.map((function(e){return{label:e.name,value:"${"+e.key+"}"}})),e};return(0,l.useEffect)((function(){var e,t;if(!S&&(null==(e=N.actions)||null==(t=e.update)||!t.criteria)){var s=(0,o.Z)({},N);delete s.actions.update,Z((0,o.Z)({},s))}}),[S]),(0,m.jsxs)("div",{className:"pos-rel",children:[(0,m.jsxs)("div",{className:"d-flx flx-wrp",children:[(null==(t=N.default)||null==(s=t.worksheets)||null==(r=s.headers)||null==(n=r[N.worksheet])?void 0:n[N.headerRow])&&(0,m.jsx)(u.Z,{action:function(){var e;if(null==(e=N.actions)||!e.update){var t=(0,o.Z)({},N);t.actions.update={insert:!0,criteria:"",firstMatch:!1},Z((0,o.Z)({},t))}R(!0)},children:(0,m.jsx)(c.Z,{onChange:function(e){return function(e,t){var s,a=(0,o.Z)({},N);"update"===t&&(!e.target.checked||null!=a&&null!=(s=a.actions)&&s.update?delete a.actions.update:(a.actions.update={insert:!0,criteria:"",firstMatch:!1},R(!0))),Z((0,o.Z)({},a))}(e,"update")},checked:"update"in(null==N?void 0:N.actions),className:"wdt-200 mt-4 mr-2",value:"Upsert_Record",title:(0,a.__)("Update Row","bitform"),subTitle:(0,a.__)("Control how the row gets updated.","bitform")})}),(0,m.jsx)(c.Z,{onChange:function(){var e=(0,o.Z)({},N);e.actions.share||(e.actions.share=[{email:"",field:"",access:"view",accessLabel:"Read Only"},{email:"",field:"",access:"view_and_comment",accessLabel:"Read/Comment"},{email:"",field:"",access:"edit",accessLabel:"Read/Edit"},{email:"",field:"",access:"share",accessLabel:"Co-Owner"},{email:"",field:"",access:"remove_share",accessLabel:"Remove Share"}]),Z((0,o.Z)({},e)),W({show:"share"})},checked:(null==N||null==(f=N.actions)||null==(b=f.share)?void 0:b.find((function(e){return e.email})))||!1,className:"wdt-200 mt-4 mr-2",value:"user_share",title:(0,a.__)("Share Workbook","bitform"),subTitle:(0,a.__)("Share workbook with users pushed to Zoho Sheet.","bitform")})]}),(0,m.jsx)(h.Z,{md:!0,show:S,setModal:R,title:(0,a.__)("Update Row","bitform"),children:(0,m.jsx)("div",{className:"o-a",children:(null==N||null==(k=N.actions)?void 0:k.update)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("small",{children:(0,a.__)("Enter the criteria to update rows. Please use the below format.","bitform")}),(0,m.jsx)("br",{}),(0,m.jsxs)("div",{className:"mt-4",children:[(0,m.jsxs)("small",{children:["Example: ",'("Month"="March" or "Month"="April") and "Amount">30']}),(0,m.jsx)("br",{}),(0,m.jsx)("small",{children:"Here Month and Amount are Zoho Sheet's worksheet header name"})," ",(0,m.jsx)("span",{className:"icn-btn ml-2 tooltip",style:{"--tooltip-txt":'"Supported Relational Operators: =, !=, <, >, <=, >=, contains"',fontSize:15},children:(0,m.jsx)("span",{className:"btcd-icn icn-information-outline"})}),(0,m.jsx)("textarea",{name:"",rows:"5",className:"btcd-paper-inp mt-1",onChange:function(e){return M(e.target.value,"criteria")},value:null==(p=N.actions)||null==(w=p.update)?void 0:w.criteria})]}),(0,m.jsx)("div",{className:"font-w-m mt-3",children:(0,a.__)("Update Preferance","bitform")}),(0,m.jsx)("small",{children:(0,a.__)("update row for first match only?","bitform")}),(0,m.jsxs)("div",{children:[(0,m.jsx)(d.Z,{onChange:function(){return M(!0,"firstMatch")},radio:!0,checked:null==(x=N.actions.update)?void 0:x.firstMatch,name:"firstMatch",title:(0,a.__)("Yes","bitform")}),(0,m.jsx)(d.Z,{onChange:function(){return M(!1,"firstMatch")},radio:!0,checked:!(null!=(v=N.actions.update)&&v.firstMatch),name:"firstMatch",title:(0,a.__)("No","bitform")})]}),(0,m.jsx)("small",{children:(0,a.__)("insert new row if the above criteria doesn't met?","bitform")}),(0,m.jsxs)("div",{children:[(0,m.jsx)(d.Z,{onChange:function(){return M(!0,"insert")},radio:!0,checked:null==(j=N.actions.update)?void 0:j.insert,name:"up-row",title:(0,a.__)("Yes","bitform")}),(0,m.jsx)(d.Z,{onChange:function(){return M(!1,"insert")},radio:!0,checked:!(null!=(_=N.actions.update)&&_.insert),name:"up-row",title:(0,a.__)("No","bitform")})]})]})})}),(0,m.jsx)(h.Z,{md:!0,show:"share"===I.show,setModal:function(){return W({show:!1})},title:(0,a.__)("Share Settings","bitform"),children:(0,m.jsx)("div",{className:"o-a",style:{height:"95%"},children:(null==N||null==(g=N.actions)||null==(C=g.share)?void 0:C.length)>0&&N.actions.share.map((function(e,t){return(0,m.jsxs)("div",{className:"flx flx-between mt-2",children:[(0,m.jsx)(i.Z,{className:"btcd-paper-drpdwn w-7 mr-2",placeholder:"Input Email Address(s)",defaultValue:e.email,onChange:function(e){return function(e,t,s){var a,r=(0,o.Z)({},N);null!=(a=r.actions)&&a.share||(r.actions.share=[]),r.actions.share[e][t]=s,Z((0,o.Z)({},r))}(t,"email",e)},options:L(),customValue:!0}),(0,m.jsx)("input",{className:"btcd-paper-inp w-3",type:"text",value:e.accessLabel,readOnly:!0})]},e.accessLabel)}))})})]})}var b=s(94253),k=s(44084),p=s(84448),w=s(94557),x=s(2699),v=s(37029);function j(e){var t,s,r,o=e.i,l=e.formFields,i=e.field,d=e.sheetConf,c=e.setSheetConf,h=(0,k.sJ)(p.hi).isPro;return(0,m.jsxs)("div",{className:"flx mt-2 mr-1",children:[(0,m.jsxs)("div",{className:"flx integ-fld-wrp",children:[(0,m.jsxs)("select",{className:"btcd-paper-inp mr-2",name:"formField",value:i.formField||"",onChange:function(e){return(0,n.wX)(e,o,d,c)},children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Field","bitform")}),(0,m.jsx)("optgroup",{label:"Form Fields",children:l.map((function(e){return"file-up"!==e.type&&(0,m.jsx)("option",{value:e.key,children:e.name},"ff-zhcrm-"+e.key)}))}),(0,m.jsx)("option",{value:"custom",children:(0,a.__)("Custom...","bitform")}),(0,m.jsx)("optgroup",{label:"General Smart Codes "+(h?"":"(PRO)"),children:h&&(null==x.C?void 0:x.C.map((function(e){return(0,m.jsx)("option",{value:e.name,children:e.label},"ff-rm-"+e.name)})))})]}),"custom"===i.formField&&(0,m.jsx)(v.Z,{onChange:function(e){return(0,n.mG)(e,o,d,c)},label:(0,a.__)("Custom Value","bitform"),className:"mr-2",type:"text",value:i.customValue,placeholder:(0,a.__)("Custom Value","bitform")}),(0,m.jsxs)("select",{className:"btcd-paper-inp",name:"zohoFormField",value:i.zohoFormField||"",onChange:function(e){return(0,n.wX)(e,o,d,c)},children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Field","bitform")}),(null==(t=d.default.worksheets)||null==(s=t.headers)||null==(r=s[d.worksheet])?void 0:r[d.headerRow])&&Object.values(d.default.worksheets.headers[d.worksheet][d.headerRow]).map((function(e){return(0,m.jsx)("option",{value:e,children:e},e+"-1")}))]})]}),(0,m.jsx)("button",{onClick:function(){return(0,n.FP)(o,d,c)},className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),(0,m.jsx)("button",{onClick:function(){return(0,n.T5)(o,d,c)},className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:(0,m.jsx)(w.Z,{})})]})}function _(e){var t,s,o,l,i,d,c,h=e.formID,u=e.formFields,k=e.handleInput,p=e.sheetConf,w=e.setSheetConf,x=e.isLoading,v=e.setisLoading,_=e.setSnackbar;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("br",{}),(0,m.jsx)("b",{className:"wdt-150 d-in-b",children:(0,a.__)("Workbook:","bitform")}),(0,m.jsxs)("select",{onChange:k,name:"workbook",value:p.workbook,className:"btcd-paper-inp w-7",children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Workbook","bitform")}),(null==p||null==(t=p.default)?void 0:t.workbooks)&&Object.keys(p.default.workbooks).map((function(e){return(0,m.jsx)("option",{value:p.default.workbooks[e].workbookId,children:p.default.workbooks[e].workbookName},e)}))]}),(0,m.jsx)("button",{onClick:function(){return(0,b.h4)(h,p,w,v,_)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Workbooks"'},type:"button",disabled:x,children:"↻"}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),(0,m.jsx)("b",{className:"wdt-150 d-in-b",children:"Worksheet:"}),(0,m.jsxs)("select",{onChange:k,name:"worksheet",value:p.worksheet,className:"btcd-paper-inp w-7",children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Worksheet","bitform")}),(null==p||null==(s=p.default)||null==(o=s.worksheets)?void 0:o[p.workbook])&&p.default.worksheets[p.workbook].map((function(e){return(0,m.jsx)("option",{value:e,children:e},e)}))]}),(0,m.jsx)("button",{onClick:function(){return(0,b.Co)(h,p,w,v,_)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Worksheets"'},type:"button",disabled:x,children:"↻"}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),(0,m.jsx)("b",{className:"wdt-150 d-in-b",children:(0,a.__)("Header Row:","bitform")}),(0,m.jsx)("input",{type:"number",min:"1",className:"btcd-paper-inp w-4",placeholder:"Header Row",onChange:k,value:p.headerRow,name:"headerRow"}),(0,m.jsx)("button",{onClick:function(){return(0,b.kS)(h,p,w,v,_)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Worksheet Headers"'},type:"button",disabled:x,children:"↻"}),(0,m.jsx)("br",{}),(0,m.jsx)("small",{className:"mt-3 d-blk",style:{marginLeft:155,lineHeight:1.8},children:(0,a.__)("By default, first row of the worksheet is considered as header row. This can be used if tabular data starts from any row other than the first row.","bitform")}),(0,m.jsx)("br",{}),x&&(0,m.jsx)(r.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(null==(l=p.default)||null==(i=l.worksheets)||null==(d=i.headers)||null==(c=d[p.worksheet])?void 0:c[p.headerRow])&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)("b",{className:"wdt-100",children:(0,a.__)("Map Fields","bitform")})}),(0,m.jsx)("div",{className:"btcd-hr mt-1"}),(0,m.jsxs)("div",{className:"flx flx-around mt-2 mb-1",children:[(0,m.jsx)("div",{className:"txt-dp",children:(0,m.jsx)("b",{children:(0,a.__)("Form Fields","bitform")})}),(0,m.jsx)("div",{className:"txt-dp",children:(0,m.jsx)("b",{children:(0,a.__)("Zoho Fields","bitform")})})]}),p.field_map.map((function(e,t){return(0,m.jsx)(j,{i:t,field:e,sheetConf:p,formFields:u,setSheetConf:w},"sheet-m-"+(t+9))})),(0,m.jsx)("div",{className:"txt-center  mt-2",style:{marginRight:85},children:(0,m.jsx)("button",{onClick:function(){return(0,n.FP)(p.field_map.length,p,w)},className:"icn-btn sh-sm",type:"button",children:"+"})}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{})]}),p.workbook&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)("b",{className:"wdt-100",children:(0,a.__)("Actions","bitform")})}),(0,m.jsx)("div",{className:"btcd-hr mt-1"}),(0,m.jsx)(f,{sheetConf:p,setSheetConf:w,formFields:u})]})]})}},44246:(e,t,s)=>{s.d(t,{Z:()=>r});var a=s(4637);const r=function(e){var t=e.className,s=e.disabled,r=e.checked,n=e.onChange,o=e.radio,l=e.name,i=e.title,d=e.value,c=e.sqr;return(0,a.jsxs)("label",{className:"btcd-ck-wrp "+t,children:[i,(0,a.jsx)("input",{type:o?"radio":"checkbox",checked:r,onChange:n,name:l,value:d,disabled:s}),(0,a.jsx)("span",{className:"btcd-mrk "+(!c&&"br-50")+" "+(o?"rdo":"ck")})]})}},31702:(e,t,s)=>{s.d(t,{Z:()=>n});var a=s(61473),r=s(4637);function n(e){var t=e.action,s=e.children;return(0,r.jsxs)("div",{className:"action-btn-wrapper",children:[(0,r.jsx)("div",{className:"action-btn",tabIndex:"0",role:"button",onClick:t,onKeyPress:t,children:(0,r.jsx)(a.Z,{})}),s]})}}}]);