var b=Object.defineProperty;var u=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var x=(e,t,s)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,o=(e,t)=>{for(var s in t||(t={}))f.call(t,s)&&x(e,s,t[s]);if(u)for(var s of u(t))y.call(t,s)&&x(e,s,t[s]);return e};import{c as j,d as p,_ as c,j as a,T as F,cI as _,w as N}from"./main-398.js";const S=(e,t,s,i,n,r,l,d)=>{const m=o({},t),{name:h}=e.target;e.target.value!==""?m[h]=e.target.value:delete m[h],s(o({},m))},v=(e=null,t,s)=>{var r;const i={formID:e,id:(r=t.id)!=null?r:null,apiKey:t.apiKey,apiSecret:t.apiSecret,tokenDetails:t.tokenDetails},n=j(i,"bitforms_dropbox_get_all_folders").then(l=>{if(l&&l.success){const d=o({},t);return l.data.dropboxFoldersList&&(d.foldersList=l.data.dropboxFoldersList,d.tokenDetails=l.data.tokenDetails),s(d),"Dropbox Folders List refreshed successfully"}else return"Dropbox Folders List refresh failed. please try again"});p.promise(n,{success:l=>l,error:c("Error Occurred"),loading:c("Loading Dropbox Folders List...")})},I=(e,t,s,i)=>{if(!e.accessCode||!e.apiKey||!e.apiSecret){p.error(c("Dropbox ApiKey, ApiSecret & Access Code can't be empty"));return}i(!0);const n={apiKey:e.apiKey,apiSecret:e.apiSecret,accessCode:e.accessCode};j(n,"bitforms_dropbox_authorization").then(r=>{if(r&&r.success){const l=o({},e);l.tokenDetails=r.data,t(l),s(!0),p.success(c("Authorized Successfully"))}else r&&r.data&&r.data.data||!r.success&&typeof r.data=="string"?p.error(`${c("Authorization failed Cause: ")}${r.data.data||r.data}. ${c("please try again")}`):p.error(c("Authorization failed. please try again"));i(!1)})};function k({dropboxConf:e,setDropboxConf:t}){var i;const s=(n,r)=>{const l=o({},e);r==="deleteFile"&&(n.target.checked?l.actions.delete_from_wp=!0:delete l.actions.delete_from_wp),t(o({},l))};return a.jsx("div",{className:"pos-rel d-flx w-8",children:a.jsx(F,{checked:((i=e.actions)==null?void 0:i.delete_from_wp)||!1,onChange:n=>s(n,"deleteFile"),className:"mt-4 mr-2",value:"delete_from_wp",title:c("Delete File From Wordpress"),subTitle:c("Delete file from Wordpress after upload in Dropbox")})})}const g=(e,t,s)=>{const i=o({},t);i.field_map.splice(e,0,{}),s(o({},i))},w=(e,t,s)=>{const i=o({},t);i.field_map.length>1&&i.field_map.splice(e,1),s(o({},i))};function D({i:e,formFields:t,field:s,dropboxConf:i,setDropboxConf:n}){const r=(l,d)=>{const m=o({},i);m.field_map[d][l.target.name]=l.target.value,n(o({},m))};return a.jsx("div",{className:"flx mt-2 mr-1",children:a.jsxs("div",{className:"pos-rel flx",children:[a.jsxs("div",{className:"flx integ-fld-wrp",children:[a.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:s.formField||"",onChange:l=>r(l,e),children:[a.jsx("option",{value:"",children:c("Select Field")}),t==null?void 0:t.filter(l=>l.type==="file-up").map(l=>a.jsx("option",{value:l.key,children:l.name},`ff-rm-${l.key}`))]}),a.jsxs("select",{className:"btcd-paper-inp",name:"dropboxFormField",value:s.dropboxFormField,onChange:l=>r(l,e),children:[a.jsx("option",{value:"",children:c("Select Folder")}),_(i.foldersList,"lowerPath","ASC").map(({name:l,lowerPath:d})=>a.jsx("option",{value:d,children:d.substring(1).split("/").map(m=>m.replace("/",">")).join(" > ")},d))]})]}),a.jsx("button",{onClick:()=>g(e,i,n),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),a.jsx("button",{onClick:()=>w(e,i,n),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:a.jsx(N,{})})]})})}function K({formID:e,formFields:t,dropboxConf:s,setDropboxConf:i,isLoading:n,setIsLoading:r}){return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mt-5",children:[a.jsx("b",{className:"wdt-100",children:c("Field Map")}),a.jsx("button",{onClick:()=>v(e,s,i),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${c("Fetch All Dropbox Folders")}'`},type:"button",children:"â†»"})]}),a.jsx("div",{className:"btcd-hr mt-1"}),a.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:c("File Input")})}),a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:c("Dropbox Folder")})})]}),s==null?void 0:s.field_map.map((l,d)=>a.jsx(D,{i:d,field:l,formFields:t,dropboxConf:s,setDropboxConf:i},`rp-m-${d+9}`)),a.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:a.jsx("button",{onClick:()=>g(s.field_map.length,s,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("div",{className:"mt-4",children:a.jsx("b",{className:"wdt-100",children:c("Actions")})}),a.jsx("div",{className:"btcd-hr mt-1"}),a.jsx(k,{dropboxConf:s,setDropboxConf:i})]})}export{K as D,I as a,v as g,S as h};
